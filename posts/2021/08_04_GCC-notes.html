<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>【GCC】GCC笔记 | 施斌斌的知识库</title>
    <meta name="description" content="专注 & 洞察 & 分享">
    <meta name="generator" content="VitePress v1.1.3">
    <link rel="preload stylesheet" href="/assets/style.C1PF0lAd.css" as="style">
    <script type="module" src="/assets/chunks/metadata.f58d5b4f.js"></script>
    <script type="module" src="/assets/app.D_04OQaE.js"></script>
    <link rel="preload" href="/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/assets/chunks/framework.s8d9Ue88.js">
    <link rel="modulepreload" href="/assets/chunks/theme.DWADtOr-.js">
    <link rel="modulepreload" href="/assets/posts_2021_08_04_GCC-notes.md.O23HiYeD.lean.js">
    <link rel="icon" href="/vitepress-logo-mini.svg">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-5d98c3a5><!--[--><!--]--><!--[--><span tabindex="-1" data-v-0f60ec36></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-0f60ec36> Skip to content </a><!--]--><!----><header class="VPNav" data-v-5d98c3a5 data-v-ae24b3ad><div class="VPNavBar top" data-v-ae24b3ad data-v-ccf7ddec><div class="wrapper" data-v-ccf7ddec><div class="container" data-v-ccf7ddec><div class="title" data-v-ccf7ddec><div class="VPNavBarTitle" data-v-ccf7ddec data-v-ab179fa1><a class="title" href="/" data-v-ab179fa1><!--[--><!--]--><!----><span data-v-ab179fa1>ShiBin&#39;s Wiki</span><!--[--><!--]--></a></div></div><div class="content" data-v-ccf7ddec><div class="content-body" data-v-ccf7ddec><!--[--><!--]--><div class="VPNavBarSearch search" data-v-ccf7ddec><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-ccf7ddec data-v-7f418b0f><span id="main-nav-aria-label" class="visually-hidden" data-v-7f418b0f>Main Navigation</span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/archives.html" tabindex="0" data-v-7f418b0f data-v-9c663999><!--[--><span data-v-9c663999>Blogs</span><!--]--></a><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-7f418b0f data-v-b6c34ac9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-b6c34ac9><span class="text" data-v-b6c34ac9><!----><span data-v-b6c34ac9>CS Primer</span><span class="vpi-chevron-down text-icon" data-v-b6c34ac9></span></span></button><div class="menu" data-v-b6c34ac9><div class="VPMenu" data-v-b6c34ac9 data-v-e7ea1737><div class="items" data-v-e7ea1737><!--[--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/csprimer/os/" data-v-43f1e123><!--[-->OS<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/csprimer/network/" data-v-43f1e123><!--[-->Network<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/csprimer/database/" data-v-43f1e123><!--[-->Database<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/csprimer/compiler/" data-v-43f1e123><!--[-->Compiler<!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-7f418b0f data-v-b6c34ac9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-b6c34ac9><span class="text" data-v-b6c34ac9><!----><span data-v-b6c34ac9>Linux</span><span class="vpi-chevron-down text-icon" data-v-b6c34ac9></span></span></button><div class="menu" data-v-b6c34ac9><div class="VPMenu" data-v-b6c34ac9 data-v-e7ea1737><div class="items" data-v-e7ea1737><!--[--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/linux/01basic/" data-v-43f1e123><!--[-->Basic<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/linux/02app/" data-v-43f1e123><!--[-->App<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/linux/03kernel/" data-v-43f1e123><!--[-->Kernel<!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-7f418b0f data-v-b6c34ac9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-b6c34ac9><span class="text" data-v-b6c34ac9><!----><span data-v-b6c34ac9>Language</span><span class="vpi-chevron-down text-icon" data-v-b6c34ac9></span></span></button><div class="menu" data-v-b6c34ac9><div class="VPMenu" data-v-b6c34ac9 data-v-e7ea1737><div class="items" data-v-e7ea1737><!--[--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/lang/assembly/" data-v-43f1e123><!--[-->Assembly<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/lang/c/" data-v-43f1e123><!--[-->C<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/lang/c++/" data-v-43f1e123><!--[-->C++<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/lang/rust/" data-v-43f1e123><!--[-->Rust<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/lang/typescript/" data-v-43f1e123><!--[-->JS/TS<!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup" data-v-7f418b0f data-v-b6c34ac9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-b6c34ac9><span class="text" data-v-b6c34ac9><!----><span data-v-b6c34ac9>Misc</span><span class="vpi-chevron-down text-icon" data-v-b6c34ac9></span></span></button><div class="menu" data-v-b6c34ac9><div class="VPMenu" data-v-b6c34ac9 data-v-e7ea1737><div class="items" data-v-e7ea1737><!--[--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/misc/cmake/index.html" data-v-43f1e123><!--[-->CMake<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/misc/cheatsheet/index.html" data-v-43f1e123><!--[-->Cheat Sheet<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/misc/talks.html" data-v-43f1e123><!--[-->Talks<!--]--></a></div><!--]--><!--[--><div class="VPMenuLink" data-v-e7ea1737 data-v-43f1e123><a class="VPLink link" href="/misc/about_me.html" data-v-43f1e123><!--[-->About Me<!--]--></a></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-ccf7ddec data-v-e6aabb21><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="Switch to dark theme" aria-checked="false" data-v-e6aabb21 data-v-d1f28634 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-d1f28634></span><span class="vpi-moon moon" data-v-d1f28634></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-ccf7ddec data-v-0394ad82 data-v-7bc22406><!--[--><a class="VPSocialLink no-icon" href="https://github.com/WShiBin" aria-label="github" target="_blank" rel="noopener" data-v-7bc22406 data-v-eee4e7cb><span class="vpi-social-github" /></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-ccf7ddec data-v-d0bd9dde data-v-b6c34ac9><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-b6c34ac9><span class="vpi-more-horizontal icon" data-v-b6c34ac9></span></button><div class="menu" data-v-b6c34ac9><div class="VPMenu" data-v-b6c34ac9 data-v-e7ea1737><!----><!--[--><!--[--><!----><div class="group" data-v-d0bd9dde><div class="item appearance" data-v-d0bd9dde><p class="label" data-v-d0bd9dde>Appearance</p><div class="appearance-action" data-v-d0bd9dde><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title="Switch to dark theme" aria-checked="false" data-v-d0bd9dde data-v-d1f28634 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-d1f28634></span><span class="vpi-moon moon" data-v-d1f28634></span><!--]--></span></span></button></div></div></div><div class="group" data-v-d0bd9dde><div class="item social-links" data-v-d0bd9dde><div class="VPSocialLinks social-links-list" data-v-d0bd9dde data-v-7bc22406><!--[--><a class="VPSocialLink no-icon" href="https://github.com/WShiBin" aria-label="github" target="_blank" rel="noopener" data-v-7bc22406 data-v-eee4e7cb><span class="vpi-social-github" /></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-ccf7ddec data-v-e5dd9c1c><span class="container" data-v-e5dd9c1c><span class="top" data-v-e5dd9c1c></span><span class="middle" data-v-e5dd9c1c></span><span class="bottom" data-v-e5dd9c1c></span></span></button></div></div></div></div><div class="divider" data-v-ccf7ddec><div class="divider-line" data-v-ccf7ddec></div></div></div><!----></header><div class="VPLocalNav empty fixed" data-v-5d98c3a5 data-v-a6f0e41e><div class="container" data-v-a6f0e41e><!----><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-a6f0e41e data-v-267dd0ed><button data-v-267dd0ed>Return to top</button><!----></div></div></div><!----><div class="VPContent" id="VPContent" data-v-5d98c3a5 data-v-1428d186><div class="VPDoc has-aside" data-v-1428d186 data-v-39a288b8><!--[--><!--]--><div class="container" data-v-39a288b8><div class="aside" data-v-39a288b8><div class="aside-curtain" data-v-39a288b8></div><div class="aside-container" data-v-39a288b8><div class="aside-content" data-v-39a288b8><div class="VPDocAside" data-v-39a288b8 data-v-3f215769><!--[--><!--]--><!--[--><!--]--><div class="VPDocAsideOutline" role="navigation" data-v-3f215769 data-v-935f8a84><div class="content" data-v-935f8a84><div class="outline-marker" data-v-935f8a84></div><div class="outline-title" role="heading" aria-level="2" data-v-935f8a84>On this page</div><nav aria-labelledby="doc-outline-aria-label" data-v-935f8a84><span class="visually-hidden" id="doc-outline-aria-label" data-v-935f8a84> Table of Contents for current page </span><ul class="VPDocOutlineItem root" data-v-935f8a84 data-v-b933a997><!--[--><!--]--></ul></nav></div></div><!--[--><!--]--><div class="spacer" data-v-3f215769></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-39a288b8><div class="content-container" data-v-39a288b8><!--[--><!--[--><!--[--><div data-v-0fd4bd6f><span class="date" data-v-0fd4bd6f> Published at: </span></div><!--]--><!--]--><!--]--><main class="main" data-v-39a288b8><div style="position:relative;" class="vp-doc _posts_2021_08_04_GCC-notes" data-v-39a288b8><div><h1 id="gcc笔记" tabindex="-1">GCC笔记 <a class="header-anchor" href="#gcc笔记" aria-label="Permalink to &quot;GCC笔记&quot;">​</a></h1><h2 id="小故事" tabindex="-1">小故事 <a class="header-anchor" href="#小故事" aria-label="Permalink to &quot;小故事&quot;">​</a></h2><p>通过在编译器里面做手脚，给程序加后门 TODO</p><h2 id="编译器" tabindex="-1">编译器 <a class="header-anchor" href="#编译器" aria-label="Permalink to &quot;编译器&quot;">​</a></h2><p>作用:把代码 翻译成可执行程序</p><img src="/assets/image-20210716002956629.CpydhtOb.webp" style="zoom:50%;"><p>如何编译?如何运行?这两个阶段干了什么?</p><h2 id="gcc编译器" tabindex="-1">GCC编译器 <a class="header-anchor" href="#gcc编译器" aria-label="Permalink to &quot;GCC编译器&quot;">​</a></h2><p>官网:<a href="https://gcc.gnu.org/" target="_blank" rel="noreferrer">https://gcc.gnu.org/</a></p><p>GCC文档:<a href="https://gcc.gnu.org/onlinedocs/gcc-8.5.0/gcc/#toc-GCC-Command-Options" target="_blank" rel="noreferrer">https://gcc.gnu.org/onlinedocs/gcc-8.5.0/gcc/#toc-GCC-Command-Options</a></p><p>书籍推荐:<a href="https://book.douban.com/subject/1787854/" target="_blank" rel="noreferrer">An Introduction to GCC</a></p><blockquote><p>Note:多版本并行开发.最新版本已经到了GCC11了, 老版本7.X也还在更新; 和普通微信及其他app开发有区别.</p><p>之前在开阳开发时版本4.9.x, (<a href="https://gcc.gnu.org/gcc-4.9/" target="_blank" rel="noreferrer">GCC 4.9.4</a> released [2016-08-03])</p></blockquote><p>GCC全称GNU Compiler Collection, GCC是一个工具集合,在编译代码的时候也是团队协作,跟我们开发一样,不同的阶段交给不同的人去处理. 比如:预处理器,链接器(linker:ld)</p><h3 id="编译四步骤" tabindex="-1">编译四步骤: <a class="header-anchor" href="#编译四步骤" aria-label="Permalink to &quot;编译四步骤:&quot;">​</a></h3><ol><li>预处理：宏定义展开、头文件展开、条件编译，这里并不会检查语法</li><li>编译：检查语法，将预处理后文件编译生成汇编文件</li><li>汇编：将汇编文件生成目标文件(二进制文件)</li><li>链接：将目标文件链接为可执行程序</li></ol><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 1.预处理</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gcc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -E</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> main.c</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> main.i</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gcc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -E</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -C</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> main.c</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> main.i</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # 保留注释</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 2.编译</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gcc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -S</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> main.c</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> main.s</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gcc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -S</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> main.c</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> main1.s</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -fverbose-asm</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> # verbose</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 3.汇编</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gcc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -c</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> main.s</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> main.o</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 4.链接</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gcc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> main.c</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> a.out</span></span></code></pre></div><p><strong>实际项目编译,从输出日志可以分为两步:</strong></p><p>取自cmake编译缓存文件；如果你要定要一个gcc编译器的公式的话，就是下面这些了（还有生成库）</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 第一步:1.2.3.把项目里面单个.c文件编译成.o文件:gcc -o main.c.o -C main.c</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">COMPILER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">DEFINES</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">INCLUDES</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">FLAGS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> -o </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">OBJECT</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> -c </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">SOURCE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 第四步:4.链接,把上面编译出来的.o文件链接在一起,如果有库也会链接</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">COMPILER</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">FLAGS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">CMAKE_C_LINK_FLAGS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">LINK_FLAGS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">OBJECTS</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> -o </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">TARGET</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &lt;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">LINK_LIBRARIES</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span></span></code></pre></div><h3 id="对于我们来说-要告诉编译器哪些" tabindex="-1">对于我们来说,要告诉编译器哪些: <a class="header-anchor" href="#对于我们来说-要告诉编译器哪些" aria-label="Permalink to &quot;对于我们来说,要告诉编译器哪些:&quot;">​</a></h3><ul><li>编译哪些源代码文件</li><li>头文件搜索路径(默认/相对路径/三方库)</li><li>库搜索路径(默认/相对路径/三方库)</li><li>编译器/链接器选项 (语言标准, 优化选项, 警告)</li><li>编译器/链接器特性</li><li>链接库</li><li>......</li></ul><h3 id="gcc怎么去解决这个问题" tabindex="-1">GCC怎么去解决这个问题: <a class="header-anchor" href="#gcc怎么去解决这个问题" aria-label="Permalink to &quot;GCC怎么去解决这个问题:&quot;">​</a></h3><ul><li>命令参数</li><li><strong>命令选项</strong></li><li>特定变量</li></ul><h3 id="命令参数" tabindex="-1">命令参数 <a class="header-anchor" href="#命令参数" aria-label="Permalink to &quot;命令参数&quot;">​</a></h3><p>gcc编译哪些源代码,库</p><h3 id="命令选项" tabindex="-1">命令选项: <a class="header-anchor" href="#命令选项" aria-label="Permalink to &quot;命令选项:&quot;">​</a></h3><p>选项大纲文档:<a href="https://gcc.gnu.org/onlinedocs/gcc-8.5.0/gcc/Option-Summary.html#Option-Summary" target="_blank" rel="noreferrer">https://gcc.gnu.org/onlinedocs/gcc-8.5.0/gcc/Option-Summary.html#Option-Summary</a></p><ul><li>-Wall: 开启大部分警告提示(建议使用),turns on all the most commonly-used compiler warnings</li><li>-std: 指定编译语言标准</li><li>-o: 指定输出文件名(o:<strong>o</strong>utput)</li><li>-Idir: 指定gcc找头文件的目录(大写i:<strong>i</strong>nclude首字母)</li><li>-Ldir: 将dir目录加入搜索库的目录路径(大写l:<strong>l</strong>ibrary首字母)</li><li>-llib: 连接lib库(小写l:library首字母)</li><li>-O: 程序优化级别(O: <strong>o</strong>ptimization)</li><li>-static: 禁止使用共享连接</li><li>-shared: 生成共享目标文件, 通常用在建立共享库时使用</li><li>-g: debug调试用,保存额外的信息到程序中</li><li>-v: 显示编译详情(v: verbose)</li></ul><h3 id="wall-开启大部分警告提示-建议使用" tabindex="-1">-Wall: 开启大部分警告提示(建议使用) <a class="header-anchor" href="#wall-开启大部分警告提示-建议使用" aria-label="Permalink to &quot;-Wall: 开启大部分警告提示(建议使用)&quot;">​</a></h3><p>gcc提供的对代码检查的选项,</p><h3 id="std-指定编译标准" tabindex="-1">-std:指定编译标准 <a class="header-anchor" href="#std-指定编译标准" aria-label="Permalink to &quot;-std:指定编译标准&quot;">​</a></h3><p><img src="/assets/image-20201216145626551.C6jrfPRk.webp" alt="" loading="lazy"></p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 使用示例</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gcc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -std=c11</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> main.c</span></span></code></pre></div><h3 id="idir-指定gcc找头文件的目录" tabindex="-1">-Idir: 指定gcc找头文件的目录 <a class="header-anchor" href="#idir-指定gcc找头文件的目录" aria-label="Permalink to &quot;-Idir: 指定gcc找头文件的目录&quot;">​</a></h3><p><a href="https://gcc.gnu.org/onlinedocs/cpp/Search-Path.html" target="_blank" rel="noreferrer">https://gcc.gnu.org/onlinedocs/cpp/Search-Path.html</a></p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 查看gcc找头文件的目录</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cpp</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -v</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/null</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/null</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">...</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cpp</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -I/home/shibin/repo</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -v</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/null</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /dev/null</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 使用示例</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gcc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -I/home/shibin/repo</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> main.c</span></span></code></pre></div><h3 id="ldir-指定gcc找库的目录" tabindex="-1">-Ldir: 指定gcc找库的目录 <a class="header-anchor" href="#ldir-指定gcc找库的目录" aria-label="Permalink to &quot;-Ldir: 指定gcc找库的目录&quot;">​</a></h3><p>查找库详情:<code>man ld</code></p><blockquote><p>The linker uses the following search paths to locate required shared libraries:</p><ol><li>Any directories specified by <strong>-rpath-link</strong> options.</li><li>Any directories specified by <strong>-rpath</strong> options. The difference between -rpath and -rpath-link is that directories specified by -rpath options are included in the xecutable and used at runtime, whereas the -rpath-link option is only effective at link time. Searching -rpath in this way is only supported by native linkers and cross linkers which have been configured with the --with-sysroot option.</li><li>On an ELF system, for native linkers, if the -rpath and -rpath-link options were not used, search the contents of the environment variable &quot;<strong>LD_RUN_PATH</strong>&quot;.</li><li>On SunOS, if the <strong>-rpath</strong> option was not used, search any directories specified using <strong>-L</strong> options.</li><li>For a native linker, search the contents of the environment variable &quot;<strong>LD_LIBRARY_PATH</strong>&quot;.</li><li>For a native ELF linker, the directories in &quot;<strong>DT_RUNPATH</strong>&quot; or &quot;<strong>DT_RPATH</strong>&quot; of a shared library are searched for shared libraries needed by it. The &quot;DT_RPATH&quot; entries re ignored if &quot;DT_RUNPATH&quot; entries exist.</li><li>The default directories, normally <strong>/lib</strong> and <strong>/usr/lib</strong>.</li><li>For a native linker on an ELF system, if the file <strong>/etc/ld.so.conf</strong> exists, the list of directories found in that file. If the required shared library is not found, the linker will issue a warning and continue with the link.</li></ol></blockquote><h3 id="llib-连接lib库" tabindex="-1">-llib: 连接lib库 <a class="header-anchor" href="#llib-连接lib库" aria-label="Permalink to &quot;-llib: 连接lib库&quot;">​</a></h3><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 使用示例</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gcc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> main.c</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -lpthread</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -lm</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -lrt</span></span></code></pre></div><h3 id="o-程序优化级别-o-optimization" tabindex="-1">-o: 程序优化级别(o: optimization) <a class="header-anchor" href="#o-程序优化级别-o-optimization" aria-label="Permalink to &quot;-o: 程序优化级别(o: optimization)&quot;">​</a></h3><p><a href="https://gcc.gnu.org/onlinedocs/gcc/Optimize-Options.html#Optimize-Options" target="_blank" rel="noreferrer">https://gcc.gnu.org/onlinedocs/gcc/Optimize-Options.html#Optimize-Options</a></p><p><a href="https://book.douban.com/subject/1787854/" target="_blank" rel="noreferrer">An Introduction to GCC</a>: 6 Compiling with optimization</p><ul><li>-O0 不优化 (default)</li><li>-O1 优化.对于大函数,优化编译占用稍微多的时间和相当大的内存.</li><li>-O2 多优化一些.除了涉及空间和速度交换的优化选项,执行几乎所有的优化工作.例如不进行循环展开(loop unrolling)和函数内嵌(inlining). 和-O选项比较,这个选项既增加了编译时间,也提高了生成代码的 运行效果.</li><li>-O3 优化的更多.除了打开-O2所做的一切,它还打开了-finline-functions选项</li></ul><p><strong>推荐使用:</strong> -O2(经验)</p><h3 id="static-禁止使用共享连接" tabindex="-1">-static: 禁止使用共享连接 <a class="header-anchor" href="#static-禁止使用共享连接" aria-label="Permalink to &quot;-static: 禁止使用共享连接&quot;">​</a></h3><p>一般不用; 当为了方便移植,可以使用</p><h3 id="shared-生成共享目标文件-通常用在建立共享库时使用" tabindex="-1">-shared: 生成共享目标文件, 通常用在建立共享库时使用 <a class="header-anchor" href="#shared-生成共享目标文件-通常用在建立共享库时使用" aria-label="Permalink to &quot;-shared: 生成共享目标文件, 通常用在建立共享库时使用&quot;">​</a></h3><p>后面介绍</p><h3 id="g-debug调试用-保存额外的信息到程序中" tabindex="-1">-g: debug调试用,保存额外的信息到程序中 <a class="header-anchor" href="#g-debug调试用-保存额外的信息到程序中" aria-label="Permalink to &quot;-g: debug调试用,保存额外的信息到程序中&quot;">​</a></h3><p>debug调试时用,会把代码,代码行号...打包到程序中,所以Debug版本的程序会比Release版本的程序大不少</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gcc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -g</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> main.c</span></span></code></pre></div><h3 id="v-显示编译详情-v-verbose" tabindex="-1">-v: 显示编译详情(v: verbose) <a class="header-anchor" href="#v-显示编译详情-v-verbose" aria-label="Permalink to &quot;-v: 显示编译详情(v: verbose)&quot;">​</a></h3><p>编译出问题,不复合预期时候用. 会告诉你gcc是怎么把程序编译出来的,有哪些选项参数,用的什么标准,开启了哪些选项</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># gcc</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gcc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -v</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> main.c</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># make</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> make</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> VERBOSE=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># cmake</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">set</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(CMAKE_VERBOSE_MAKEFILE </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">ON</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h3 id="特定变量" tabindex="-1">特定变量: <a class="header-anchor" href="#特定变量" aria-label="Permalink to &quot;特定变量:&quot;">​</a></h3><p><strong>LIBRARY_PATH</strong>:编译时需要的动态链接库</p><p><strong>LD_LIBRARY_PATH</strong>:运行时能够自动找到需要的动态链接库</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 查看程序依赖哪些共享库</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ldd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /bin/ls</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        linux-vdso.so.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (0x00007ffcc3563000)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        libselinux.so.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /lib64/libselinux.so.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (0x00007f87e5459000)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        libcap.so.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /lib64/libcap.so.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (0x00007f87e5254000)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        libc.so.6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /lib64/libc.so.6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (0x00007f87e4e92000)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        libpcre.so.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /lib64/libpcre.so.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (0x00007f87e4c22000)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        libdl.so.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /lib64/libdl.so.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (0x00007f87e4a1e000)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        /lib64/ld-linux-x86-64.so.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (0x00005574bf12e000)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        libattr.so.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /lib64/libattr.so.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (0x00007f87e4817000)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        libpthread.so.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /lib64/libpthread.so.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (0x00007f87e45fa000)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> export</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> LD_LIBRARY_PATH=/home/shibin/repo/foo/target/lib</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ./a.out</span></span></code></pre></div><h2 id="库" tabindex="-1">库 <a class="header-anchor" href="#库" aria-label="Permalink to &quot;库&quot;">​</a></h2><p>复用的代码</p><p>编译时,主要发生在程序的链接阶段; 运行</p><h3 id="静态库" tabindex="-1">静态库 <a class="header-anchor" href="#静态库" aria-label="Permalink to &quot;静态库&quot;">​</a></h3><p>目标文件的<strong>归档文档</strong>;可以理解成一组目标文件的集合; 用ar工具去打包,后缀名为.a,(archive file)</p><p><strong>格式:</strong></p><ul><li>Unix: lib<strong>NAME</strong>.a</li><li>Windows: lib<strong>NAME</strong>.lib</li><li>macOS: lib<strong>NAME</strong>.a</li></ul><p><strong>特征:</strong></p><ul><li>文件格式是非可执行程序格式(elf格式)</li><li>链接时,<strong>目标可执行程序</strong>只取我需要的部分,合并到可执行文件中.(可移植性高)；</li><li>运行时会被全部加载到内存(内存占用高)</li></ul><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 打包成静态库</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gcc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -c</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> add.c</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> sub.c</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ar</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> crs</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> libname.a</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> file1.o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> file2.o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> file3.o</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 查看静态库的内容表(table of content)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ar</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> t</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> libname.a</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 使用静态库</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gcc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> main.o</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> a.out</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> libname.a</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gcc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> main.o</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> a.out</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -L.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -lname</span></span></code></pre></div><h3 id="动态库-共享库" tabindex="-1">动态库(共享库) <a class="header-anchor" href="#动态库-共享库" aria-label="Permalink to &quot;动态库(共享库)&quot;">​</a></h3><p>也叫共享库<strong>s</strong>hared <strong>o</strong>bject,顾名思义,可以多个程序共享; 文件后缀名为.so,</p><p><strong>格式:</strong></p><ul><li>Unix: lib<strong>NAME</strong>.so</li><li>Windows: lib<strong>NAME</strong>.dll</li><li>macOS: lib<strong>NAME</strong>.dylib</li></ul><p><strong>特征:</strong></p><ul><li>文件格式是可执行程序格式(elf格式)</li><li>链接时,<strong>目标可执行程序</strong>只记录相应的库信息(函数表).(可移植性低)(ldd executable_name)</li><li>运行时调用该库函数时才会被全部加载到内存;并且多个程序只会加载一份到内存中(多个程序同时去年时.内存占用低)</li></ul><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 打包动态库</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gcc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -fpic</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -c</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> file1.c</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> file2.c</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gcc</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -shared</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> libname.so</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> file1.o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> file2.o</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 查看动态库中有哪些函数</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> readelf</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -Ws</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /lib/x86_64-linux-gnu/libselinux.so.1</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 使用动态库</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> gcc</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> main.o</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -o</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> a.out</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -L.</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -lname</span></span></code></pre></div><h3 id="静态库-vs-动态库" tabindex="-1">静态库 vs 动态库: <a class="header-anchor" href="#静态库-vs-动态库" aria-label="Permalink to &quot;静态库 vs 动态库:&quot;">​</a></h3><ul><li>移植性:静态库可移植性好,移植的时候拷贝程序就可以了</li><li>更新,部署:动态库更新只需要更新单独的库;而静态库需要编译整个程序</li><li>内存占用:动态库被一个或多个进程共享(代码段);静态库所在的每个进程,都会加载一份到内存</li></ul><h3 id="运行时" tabindex="-1">运行时: <a class="header-anchor" href="#运行时" aria-label="Permalink to &quot;运行时:&quot;">​</a></h3><p>ldd:查看程序依赖的共享库</p><div class="language-bash vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># Linux</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ldd</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /bin/ls</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        linux-vdso.so.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (0x00007ffcc3563000)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        libselinux.so.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /lib64/libselinux.so.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (0x00007f87e5459000)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        libcap.so.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /lib64/libcap.so.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (0x00007f87e5254000)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        libc.so.6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /lib64/libc.so.6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (0x00007f87e4e92000)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        libpcre.so.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /lib64/libpcre.so.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (0x00007f87e4c22000)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        libdl.so.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /lib64/libdl.so.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (0x00007f87e4a1e000)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        /lib64/ld-linux-x86-64.so.2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (0x00005574bf12e000)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        libattr.so.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /lib64/libattr.so.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (0x00007f87e4817000)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        libpthread.so.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> =</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /lib64/libpthread.so.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (0x00007f87e45fa000)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># macOS</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">$</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> otool</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -L</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /bin/ls</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">/bin/ls:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        /usr/lib/libutil.dylib</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (compatibility </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">version</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1.0.0,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> current</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> version</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1.0.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        /usr/lib/libncurses.5.4.dylib</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (compatibility </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">version</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 5.4.0,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> current</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> version</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 5.4.0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">        /usr/lib/libSystem.B.dylib</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (compatibility </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">version</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 1.0.0,</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> current</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> version</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1319.100.3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><h3 id="思考问题" tabindex="-1">思考问题: <a class="header-anchor" href="#思考问题" aria-label="Permalink to &quot;思考问题:&quot;">​</a></h3><ol><li>多个程序使用同一个共享库时,共享哪些内容? (代码段,只读数据),</li><li>如果同时安装了一个库的动态库和静态库,你的程序会link哪个库? 如果有动态库,默认就链接动态库</li></ol><h2 id="其它工具" tabindex="-1">其它工具: <a class="header-anchor" href="#其它工具" aria-label="Permalink to &quot;其它工具:&quot;">​</a></h2><p>UNIX 系统的本地工具, GNU Binutils</p><table><thead><tr><th>工具</th><th>描述</th></tr></thead><tbody><tr><td>ar</td><td>这是一个程序，可通过从文档中增加、删除和析取文件来维护库文件。通常使用该工具是为了创建和管理连接程序使用的目标库文档。该程序是 binutils 包的一部分</td></tr><tr><td>as</td><td>GNU 汇编器。实际上它是一族汇编器，因为它可以被编泽或能够在各种不同平台上工作。 该程序是 binutils 包的一部分</td></tr><tr><td>ld</td><td>GNU 连接程序。该程序将目标文件的集合组合成可执行程序。该程序是 binutils 包的一部</td></tr><tr><td>gcov</td><td>gprof 使用的配置工具，用来确定程序运行的时候哪一部分耗时最大</td></tr><tr><td>gdb</td><td>GNU 调试器，可用于检查程序运行时的值和行为</td></tr><tr><td>gprof</td><td>该程序会监督编泽程序的执行过程，并报告程序中各个函数的运行时间，可以根据所提供 的配置文件来优化程序。该程序是 binutils 包的一部分</td></tr><tr><td>make</td><td>一个工具程序，它会读 makefile 脚木来确定程序中的哪个部分需要编泽和连接，然后发布 必要的命令。它读出的脚木（叫做 makefile 或 Makefile）定义了文件关系和依赖关系</td></tr><tr><td>objdump</td><td>显示一个或多个目标文件中保存的多种不同信息。该程序是 binutils 包的一部分</td></tr><tr><td>readelf</td><td>从 ELF 格式的目标文件显示信息。该程序是 binutils 包的一部分</td></tr><tr><td>size</td><td>列出目标文件中每个部分的名字和尺寸。该程序是 binutils 包的一部分</td></tr><tr><td>strings</td><td>浏览所有类型的文件，析取出用于显示的字符串。该程序是 binutils 包的一部分</td></tr><tr><td>strip</td><td>从目标文件或文档库中去掉符号表，以及其他调试所需的信息。该程序是 binutils 包的一部</td></tr></tbody></table><h2 id="常见问题" tabindex="-1">常见问题 <a class="header-anchor" href="#常见问题" aria-label="Permalink to &quot;常见问题&quot;">​</a></h2><h3 id="兼容问题" tabindex="-1">兼容问题: <a class="header-anchor" href="#兼容问题" aria-label="Permalink to &quot;兼容问题:&quot;">​</a></h3><ul><li>系统平台差异</li><li>C标准库实现差异,不同的实现<a href="https://www.gnu.org/software/libc/" target="_blank" rel="noreferrer">glibc</a>,<a href="https://www.uclibc.org/" target="_blank" rel="noreferrer">uClibc</a>,<a href="https://svnweb.freebsd.org/base/head/lib/libc/" target="_blank" rel="noreferrer">FreeBSD libc</a></li><li>同一个库不同版差异</li><li>不同语言版本标准问题</li><li>不同编译器版本</li></ul><h3 id="预处理时错误信息" tabindex="-1">预处理时错误信息: <a class="header-anchor" href="#预处理时错误信息" aria-label="Permalink to &quot;预处理时错误信息:&quot;">​</a></h3><ul><li>No such file or directory</li></ul><h3 id="编译时错误信息" tabindex="-1">编译时错误信息: <a class="header-anchor" href="#编译时错误信息" aria-label="Permalink to &quot;编译时错误信息:&quot;">​</a></h3><ul><li>‘variable’ undeclared (first use in this function)</li><li>warning: implicit declaration of function ‘...’</li><li>warning: unused variable ‘...’</li><li>warning: unused parameter ‘...’</li></ul><h3 id="链接时错误信息" tabindex="-1">链接时错误信息: <a class="header-anchor" href="#链接时错误信息" aria-label="Permalink to &quot;链接时错误信息:&quot;">​</a></h3><ul><li>file not recognized: File format not recognized</li><li>undefined reference to ‘foo’ 找不到函数</li></ul><h3 id="运行时错误信息" tabindex="-1">运行时错误信息: <a class="header-anchor" href="#运行时错误信息" aria-label="Permalink to &quot;运行时错误信息:&quot;">​</a></h3><ul><li>error while loading shared libraries: cannot open shared object file: No such file or directory</li></ul><p><strong>段错误Segmentation fault:</strong></p><ul><li>dereferencing a null pointer or uninitialized pointer</li><li>out-of-bounds array access</li><li>incorrect use of malloc, free and related functions</li><li>use of scanf with invalid arguments</li></ul><h2 id="交叉编译工具链" tabindex="-1">交叉编译工具链 <a class="header-anchor" href="#交叉编译工具链" aria-label="Permalink to &quot;交叉编译工具链&quot;">​</a></h2><p>在一种计算机环境中运行的编译程序, 能编译出在另外一种环境下运行的代码, 这个编译过程就叫交叉编译</p><p>简单地说,就是<strong>在一个平台上生成另一个平台上的可执行代码</strong>.比如,X86机器上生成arm机器的程序</p><p>交叉编译工具链是一个由编译器、连接器和解释器组成的综合开发环境，交叉编译工具链主要由binutils、gcc和glibc三个部分组成。有时出于减小 libc 库大小的考虑，也可以用别的 c 库来代替 glibc，例如 uClibc、dietlibc 和 newlib</p><h3 id="分类和说明" tabindex="-1">分类和说明 <a class="header-anchor" href="#分类和说明" aria-label="Permalink to &quot;分类和说明&quot;">​</a></h3><p>从授权上，分为免费授权版和付费授权版。</p><p>免费版目前有三大主流工具商提供，第一是GNU（提供源码，自行编译制作），第二是 Codesourcery，第三是Linora。</p><p>收费版有ARM原厂提供的armcc、IAR提供的编译器等等，因为这些价格都比较昂贵，不适合学习用户使用，所以不做讲述。</p><ul><li>arm-none-linux-gnueabi-gcc：是 Codesourcery 公司（目前已经被Mentor收购）基于GCC推出的的ARM交叉编译工具。可用于交叉编译ARM（32位）系统中所有环节的代码，包括裸机程序、u-boot、Linux kernel、filesystem和App应用程序。</li><li>arm-linux-gnueabihf-gcc：是由 Linaro 公司基于GCC推出的的ARM交叉编译工具。可用于交叉编译ARM（32位）系统中所有环节的代码，包括裸机程序、u-boot、Linux kernel、filesystem和App应用程序。</li><li>aarch64-linux-gnu-gcc：是由 Linaro 公司基于GCC推出的的ARM交叉编译工具。可用于交叉编译ARMv8 64位目标中的裸机程序、u-boot、Linux kernel、filesystem和App应用程序。</li><li>arm-none-elf-gcc：是 Codesourcery 公司（目前已经被Mentor收购）基于GCC推出的的ARM交叉编译工具。可用于交叉编译ARM MCU（32位）芯片，如ARM7、ARM9、Cortex-M/R芯片程序。</li><li>arm-none-eabi-gcc：是 GNU 推出的的ARM交叉编译工具。可用于交叉编译ARM MCU（32位）芯片，如ARM7、ARM9、Cortex-M/R芯片程序。</li></ul><h3 id="命名规则" tabindex="-1">命名规则 <a class="header-anchor" href="#命名规则" aria-label="Permalink to &quot;命名规则&quot;">​</a></h3><p>交叉编译工具链的命名规则为：arch [-vendor] [-os] [-(gnu)eabi]</p><ul><li>arch – 体系架构，如ARM，MIPS（通过交叉编译工具生成的可执行文件或系统镜像的运行平台或环境）</li><li>vendor – 工具链提供商</li><li>os – 目标操作系统（host主要操作平台，也就是编译时的系统）</li><li>eabi – 嵌入式应用二进制接口（Embedded Application Binary Interface）</li></ul><p>根据对操作系统的支持与否，ARM GCC可分为支持和不支持操作系统，如</p><ul><li>arm-none-eabi：这个是没有操作系统的，自然不可能支持那些跟操作系统关系密切的函数，比如fork(2)。他使用的是newlib这个专用于嵌入式系统的C库。</li><li>arm-none-linux-eabi：用于Linux的，使用Glibc</li></ul><h3 id="实例" tabindex="-1">实例 <a class="header-anchor" href="#实例" aria-label="Permalink to &quot;实例&quot;">​</a></h3><h4 id="_1-arm-none-eabi-gcc" tabindex="-1">1. arm-none-eabi-gcc <a class="header-anchor" href="#_1-arm-none-eabi-gcc" aria-label="Permalink to &quot;1. arm-none-eabi-gcc&quot;">​</a></h4><p>（ARM architecture，no vendor，not target an operating system，complies with the ARM EABI） 用于编译 ARM 架构的裸机系统（包括 ARM Linux 的 boot、kernel，不适用编译 Linux 应用 Application），一般适合 ARM7、Cortex-M 和 Cortex-R 内核的芯片使用，所以不支持那些跟操作系统关系密切的函数，比如fork(2)，他使用的是 newlib 这个专用于嵌入式系统的C库。</p><h4 id="_2-arm-none-linux-gnueabi-gcc" tabindex="-1">2. arm-none-linux-gnueabi-gcc <a class="header-anchor" href="#_2-arm-none-linux-gnueabi-gcc" aria-label="Permalink to &quot;2. arm-none-linux-gnueabi-gcc&quot;">​</a></h4><p>(ARM architecture, no vendor, creates binaries that run on the Linux operating system, and uses the GNU EABI)</p><p>主要用于基于ARM架构的Linux系统，可用于编译 ARM 架构的 u-boot、Linux内核、linux应用等。arm-none-linux-gnueabi基于GCC，使用Glibc库，经过 Codesourcery 公司优化过推出的编译器。arm-none-linux-gnueabi-xxx 交叉编译工具的浮点运算非常优秀。一般ARM9、ARM11、Cortex-A 内核，带有 Linux 操作系统的会用到。</p><h4 id="_3-arm-eabi-gcc" tabindex="-1">3. arm-eabi-gcc <a class="header-anchor" href="#_3-arm-eabi-gcc" aria-label="Permalink to &quot;3. arm-eabi-gcc&quot;">​</a></h4><p>Android ARM 编译器。</p><h4 id="_4-armcc" tabindex="-1">4. armcc <a class="header-anchor" href="#_4-armcc" aria-label="Permalink to &quot;4. armcc&quot;">​</a></h4><p>ARM 公司推出的编译工具，功能和 arm-none-eabi 类似，可以编译裸机程序（u-boot、kernel），但是不能编译 Linux 应用程序。armcc一般和ARM开发工具一起，Keil MDK、ADS、RVDS和DS-5中的编译器都是armcc，所以 armcc 编译器都是收费的（爱国版除外，呵呵~~）。</p><h4 id="_5-arm-none-uclinuxeabi-gcc-和-arm-none-symbianelf-gcc" tabindex="-1">5. arm-none-uclinuxeabi-gcc 和 arm-none-symbianelf-gcc <a class="header-anchor" href="#_5-arm-none-uclinuxeabi-gcc-和-arm-none-symbianelf-gcc" aria-label="Permalink to &quot;5. arm-none-uclinuxeabi-gcc 和 arm-none-symbianelf-gcc&quot;">​</a></h4><p>arm-none-uclinuxeabi 用于uCLinux，使用Glibc。</p><p>arm-none-symbianelf 用于symbian，没用过，不知道C库是什么 。</p><h3 id="codesourcery" tabindex="-1">Codesourcery <a class="header-anchor" href="#codesourcery" aria-label="Permalink to &quot;Codesourcery&quot;">​</a></h3><p>Codesourcery推出的产品叫Sourcery G++ Lite Edition，其中基于command-line的编译器是免费的，在官网上可以下载，而其中包含的IDE和debug 工具是收费的，当然也有30天试用版本的。</p><p>目前CodeSourcery已经由明导国际(Mentor Graphics)收购，所以原本的网站风格已经全部变为 Mentor 样式，但是 Sourcery G++ Lite Edition 同样可以注册后免费下载。</p><p>Codesourcery一直是在做ARM目标 GCC 的开发和优化，它的ARM GCC在目前在市场上非常优秀，很多 patch 可能还没被gcc接受，所以还是应该直接用它的（而且他提供Windows下[mingw交叉编译的]和Linux下的二进制版本，比较方便；如果不是很有时间和兴趣，不建议下载 src 源码包自己编译，很麻烦，Codesourcery给的shell脚本很多时候根本没办法直接用，得自行提取关键的部分手工执行，又费精力又费时间，如果想知道细节，其实不用自己编译一遍，看看他是用什么步骤构建的即可，如果你对交叉编译器感兴趣的话。</p><h3 id="abi-和-eabi" tabindex="-1">ABI 和 EABI <a class="header-anchor" href="#abi-和-eabi" aria-label="Permalink to &quot;ABI 和 EABI&quot;">​</a></h3><p>ABI：二进制应用程序接口(Application Binary Interface (ABI) for the ARM Architecture)。在计算机中，应用二进制接口描述了应用程序（或者其他类型）和操作系统之间或其他应用程序的低级接口。</p><p>EABI：嵌入式ABI。嵌入式应用二进制接口指定了文件格式、数据类型、寄存器使用、堆积组织优化和在一个嵌入式软件中的参数的标准约定。开发者使用自己的汇编语言也可以使用 EABI 作为与兼容的编译器生成的汇编语言的接口。</p><p>两者主要区别是，ABI是计算机上的，EABI是嵌入式平台上（如ARM，MIPS等）。</p><h3 id="arm-linux-gnueabi-gcc-和-arm-linux-gnueabihf-gcc" tabindex="-1">arm-linux-gnueabi-gcc 和 arm-linux-gnueabihf-gcc <a class="header-anchor" href="#arm-linux-gnueabi-gcc-和-arm-linux-gnueabihf-gcc" aria-label="Permalink to &quot;arm-linux-gnueabi-gcc 和 arm-linux-gnueabihf-gcc&quot;">​</a></h3><p>两个交叉编译器分别适用于 armel 和 armhf 两个不同的架构，armel 和 armhf 这两种架构在对待浮点运算采取了不同的策略（有 fpu 的 arm 才能支持这两种浮点运算策略）</p></div></div></main><footer class="VPDocFooter" data-v-39a288b8 data-v-09de1c0f><!--[--><!--]--><div class="edit-info" data-v-09de1c0f><!----><div class="last-updated" data-v-09de1c0f><p class="VPLastUpdated" data-v-09de1c0f data-v-7e05ebdb>Updated at: <time datetime="2024-04-23T15:41:29.000Z" data-v-7e05ebdb></time></p></div></div><!----></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter" data-v-5d98c3a5 data-v-e315a0ad><div class="container" data-v-e315a0ad><!----><p class="copyright" data-v-e315a0ad>Copyright © 2017-2024 Shi Bin</p></div></footer><!--[--><!--]--></div></div>
    
    
  </body>
</html>